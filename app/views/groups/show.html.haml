%h2= @group.name

%p Members
- for member in @group.members
  = member.email
%p= link_to 'Add member', ''

%p Restaurants List
- for restaurant in @group.list.restaurants
  %li= restaurant.name
#search
  = form_tag user_group_list_url(:user_id => @user.id, :group_id => @group.id), :method => :put, :remote => :true do
    = text_field_tag :q, params[:q], :id => 'instant_search'
    = hidden_field_tag :rid, :id => 'rid'
    = submit_tag 'Add'

:javascript
  var query;
  var restaurant;
  var restaurant_data;
  var r_data;
  var r_names;

  function requestData(callback) {
    query = $("#instant_search").val();
    $.ajax({
      url: '/restaurants/n_instant?q=' + escape(query),
      success: function(data) {
        r_data = data.restaurants;
        r_names = [];
        for (i in r_data) {
          r_names.push(r_data[i].name);
        }
        if (callback) {
          callback();
        }
      }
    });
  }
  $(document).ready(function() {
    $("#instant_search").autocomplete({
      delay: 0,
      source: function(req, responseFn) {
        requestData(function() {
          responseFn(r_names);
        });
      },
      select: function(value, data) {
        for (i in r_data) {
          restaurant = data.item.value;
          if (r_data[i].name == restaurant) {
            restaurant_data = r_data[i];
          }
          $("#rid").val(r_data[i].id);
        }
      }
    });
  });

